library(tidyverse)
library(gsheet)

Consider the data from the abstract of research study (beginning on page 62). We have data from 22 elementary schools located in a Florida school district in 1999. Reading and math scores from a standardized test, percent minority of the particular grade level in that school, percent in poverty of the particular grade level in that school, and total number of students in that grade at that school are included.

data <- as_tibble(gsheet2tbl("https://docs.google.com/spreadsheets/d/1cVGLLdILMI34xjnzHfJNHua6fJROJwCzUBFgV22OLT4/edit#gid=0"))

1. What are the average math and reading scores for each grade?
data %>%
  group_by(Grade)  %>%
  summarize(mean_reading=mean(Reading, na.rm = TRUE),
            mean_math=mean(Math, na.rm = TRUE))

# A tibble: 3 × 3
  Grade mean_reading mean_math
  <dbl>        <dbl>     <dbl>
1     3         171.      172.
2     4         186.      190.
3     5         205.      206.
2. What are the median math scores for each grade?
data %>%
  group_by(Grade)  %>%
  summarize(median_math=mean(Math, na.rm = TRUE))

# A tibble: 3 × 2
  Grade median_math
  <dbl>       <dbl>
1     3        172.
2     4        190.
3     5        206.

3. Use ggplot() to construct histograms of the math and reading scores and determine if we should report the mean or median.
data %>%
  ggplot(aes(x=Math)) +
  geom_histogram() +
  labs(x = "value of Math Scores",
       y = "number of observations") +
  theme_bw()



data %>%
  ggplot(aes(x=Reading)) +
  geom_histogram() +
  labs(x = "value of Reading Scores",
       y = "number of observations") +
  theme_bw()



We should report the mean for math since the distribution is more symmetrical and report the median for reading since the distribution more skewed.

4. What is the average percent in poverty for each grade?
data %>%
group_by(Grade)  %>%
  summarize(mean_poverty = mean(`%Poverty`, na.rm = TRUE)) 

# A tibble: 3 × 2
  Grade mean_poverty
  <dbl>        <dbl>
1     3         58.8
2     4         54.0
3     5         56.5
5. (Challenge! … but required) Why should we be careful when reporting an average percentage of students in poverty? (Note: I am asking for a mathematical answer.)
We should be careful when reporting an average percentage of students in poverty because of the sample sizes. Even though the class could have the same percentage, in reality the samples sizes between each average percentage could be way different.

6. Use ggplot() to construct side-by-side box plots for reading and, separately, math scores by grade level (i.e., reconstruct Figure 3.33 from the textbook).
data %>%
ggplot( aes(x = as.factor(Grade), y = Reading)) +
  geom_boxplot() +
  labs(x = "Grade Level",
       y = "Reading Test Scores") +
  theme_bw()



data %>%
ggplot(aes(x = as.factor(Grade), y = Math)) +
  geom_boxplot() +
  labs(x = "Grade Level",
       y = "Math Test Scores") +
  theme_bw()



7. Use ggplot() to construct a scatterplot of reading vs. math scores for each grade level (i.e., create a different version of Figure 3.34 from the textbook).
data %>%
  ggplot(aes(y = Math, x = Reading,color = as.factor(Grade))) +
  geom_point() +
  labs(y = "Math Score",
       x = "Reading Score") +
  theme_bw()

